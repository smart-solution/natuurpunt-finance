# -*- coding: utf-8 -*-
import xmlrpclib

server='localhost'
dbname='natuurpunt_validatie46'
uid=217
pwd='patrick'

#replace localhost with the address of the server
sock = xmlrpclib.ServerProxy('http://%s:8069/xmlrpc/object'%(server))




move_line_ids = [1944544,1979994,1944493,1982014,687705,2147987,1940867,1940869,1940871,1940873,2147990,1497481,2115530,2115526,2115536,2115535,2115872,2115871,2115930,2115932,2115939,2115934,2115995,2115996,2115997,2115998,2115999,2116000,2116001,2116002,2116003,2116004,2116005,2116006,2116007,2116008,2116009,2116011,2116016,2116017,2116020,2116021,2116022,1946939,2093470,2093472,2093471,2115258,2115259,2115260,2115261,2115262,2115266,2140429,2140450,2141201,2141202,2139446,2139419,2139424,2139421,2139422,2139426,2139431,2139428,2139429,2139435,2139436,2139520,2139519,2139606,2139607,2139608,2139609,2139610,2139612,2139831,2139744,2139743,2139804,2154302,2154304,2154305,2154307,2154308,1742919,1742917,2109041,2109042,1720418,2089570,2089572,1720422,1720408,2093467,1724106,2094520,2094616,2093054,1720412,1940691,1940696,1940864,1940865,1940866,1940868,1940870,1940872,1940874,1940875,1940876,1940877,1940878,1940879,1940880,1940881,1940882,1940883,1940884,1940885,1940886,1940887,1940888,1940889,1940890,1940891,1940892,1940893,1940894,1940895,1940896,1940842,1940843,1940844,1940845,1940846,1940847,1940848,1940849,1940850,1940851,1940852,1940854,1940855,1940856,1940857,1940858,1940861,1940862,1940863,1943271,1465091,1943696,1943697,1943695,1943700,1943704,1944492,1944540,1944541,1944543,1946554,1946555,1946557,1948033,1947860,1947861,1947862,1947863,1947864,1947865,1947866,1947867,1947868,1947869,1947870,1947871,1947872,1947873,1947874,1947875,1947876,1947877,1947878,1947880,1947881,1947882,1947883,1947884,1947885,1947886,1947887,1947888,1947889,1947890,1947891,1947892,1947893,1947894,1947895,1947896,1947897,1947898,1947899,1947900,1947901,1947902,1947903,1947904,1947905,1947906,1947907,1947908,1947909,1947910,1947911,1947912,1947913,1947914,1947922,1947923,1947924,1947925,1947926,1947927,1947928,1947929,1947930,1947931,1947932,1947933,1947934,1947935,1947936,1947937,1947938,1947939,1947940,1947941,1947942,1947943,1947944,1947945,1947946,1947947,1947948,1947949,1947950,1947951,1947952,1947991,1947992,1947993,1947994,1947995,1947996,1947997,1947998,1947999,1948000,1948001,1948002,1948003,1948004,1948005,1948006,1948007,1948008,1948009,1948012,1948013,1948014,1948015,1948016,1948017,1948018,1948019,1948020,1948021,1948022,1948023,1948024,1948025,1948026,1948027,1948028,1948029,1948030,1948031,1948032,1948034,1948035,1948036,1948037,1948038,1948039,1948040,1948041,1948042,1948043,1948044,1948045,1948046,1948051,1948052,1948057,1948058,1948060,1948061,1948064,1948063,1948066,1948067,1951253,1951254,1951255,1951266,1951267,1951269,1953552,1953550,1953576,1953575,1953584,1953586,1953587,1953607,1953605,1953681,1955088,1955087,1979995,1979996,1982016,1982017,2000957,2000940,2000941,2000942,2000943,2001039,2001051,2001030,2001031,2001147,2001148,2001160,2001161,2001158,2001159,1064297,1066978,1066933,1066924,687704,730663,1716130,1716132,1716128,1716124,1716347,1716348,1053036,1052601,1187305,1187467,1187679,1342838,1714256,1342198,1385628,1385633,2151236,1940860,2004341,2151539,2004344,2134353,2134354,2134355,2134244,2134245,2134307,2134308,2134310,2134356,2134312,2134313,2134314,2134317,2134318,2134320,2134321,2134322,2134325,2134326,2134327,2134554,2134555,653651,653682,653824,653811,653840,876612,876614,851523,1751580,1751590,1751585,1751678,1751773,1753536,1753538,1753539,1753540,1753541,2093460,2093465,2093458,2093468,2093476,2093477,792376,792378,792380,1725461,1725496,1725411,1725493,1725441,2148264,2148266,2148267,2148269,2148270,2148272,2148273,2148491,2148492,2148485,2148486,2148488,2148489,2148496,2148497,2148494,2148495,2148507,2148508,2148509,1632013,1632014,1632015,1632016,1632870,1632885,1723538,1720433,1720435,1720440,1720409,1720421,1720417,1712267,1712160,1712159,1712168,1712173,1712647,1712664,1712662,1712152,1712153,1712130,1712131,1712132,1712133,1712263,1712271,1712305,1712695,1712696,1712697,1712698,1712699,1712700,1712701,838287,839467,839469,1050960,1050524,1434070,792391,792393,792409,792418,792425,792427,792429,1723544,1723542,1723540,1723548,1723549,1723528,1723527,1723532,1723533,1723534,1723554,1723552,1723551,655050,1365188,1724100,1724101,1724104,1724103,1724107,1724109,1724110,1725428,1725523,1725404,1725515,1508102,1508100,2094404,2094405,2094406,2094407,2094408,2094409,2094411,2094412,2094413,2094414,2094415,2094416,2094499,2094500,2094501,2094502,2094503,2094504,2094505,2094506,2094507,2094508,2094509,2094510,2094511,2094512,2094521,2094522,2094523,2094597,2094589,2094590,2094605,2094624,2094724,2094730,2094946,1734384,1734386,1738462,1738411,1713698,1714104,1714105,1714102,1714103,1714132,2148850,2148851,2150481,2149568,2149563,2149917,1066976,1346313,776766,1713193,1713194,1713039,1713044,1713167,1713136,1713137,1713138,1713144,1713145,1713156,1713157,1713153,1713248,1713185,1713186,1713246,1713241,1713225,1713226,1713227,1713228,1713229,1713230,1713231,1713232,1713233,1713234,1713235,1713236,1713237,1713244,1431178,1431180,1431182,1431282,1061842,1061843,1061844,1061845,1061846,1061847,1061888,1061886,1061895,1061897,2113360,2113347,2113348,2113356,2113355,2113378,2113614,2113615,2113619,2113620,2113622,1320727,1320729,1057186,1057188,2117783,2117784,2117785,2117786,2117787,2117788,2117789,2117790,2117791,2117792,2117793,2117795,2117796,2117797,2117798,2117799,2117800,2117801,2117802,2117803,2117804,2117805,2117806,2117807,2117808,2117809,2117810,2117811,2117812,2117813,2117814,2117815,2117816,2117817,2117818,2117819,2117820,2117821,2117822,2117823,2117824,2093474,2003104,2003105,2003106,2003107,2003108,2003109,2003304,2004005,2003916,2003917,2003918,2003919,2003920,2003921,2003922,2003923,2004050,2004022,2004025,2116883,2116884,2116885,2116886,2116887,2116888,2116889,2004204,2004205,2004206,2004342,2004343,2041145,2041155,2040955,2040958,2041146,2042318,2042319,2043192,2043750,2043751,2092313,2092314,2093000,2093013,2093021,2093026,2092998,2093011,2093034,2093035,2093036,2093037,2093056,2093057,2093087,2093091,2093114,2093084,2093085,2093112,2093110,2093111,2093128,2093129,2093131,2093132,2093137,2093138,2060000,2060001,2059998,2059999,2063643,2063644,2066189,2066190,2075618,2075619,2133511,2133506,2133507,2133524,2133525,2133527,2089569,2089530,2089550,2089531,2089551,2089571,2089552,2089553,2089554,2089573,2089528,2089529,2089541,2089555,2089574,2089532,2089533,2089534,2089535,2089536,2089537,2089538,2089539,2089540,2089548,2089549,2089556,2089557,2089558,2089559,2089560,2089561,2089562,2089563,2089564,2089565,2089566,2089567,2089568,2089575,2089576,2089577,2089578,1373931,1252643,1252729,1252652,1252661,1252666,1252721,1252722,1252730,1326567,1294013,2102198,2102199,2102200,2102201,2102202,2102203,1366850,1367153,1367289,1367290,1367388,1415968,2120787,2120783,2120789,2120800,2120780,2120781,2120792,2120791,2120799,2120808,2120805,2120806,2120807,2120821,2120822,1396185,1449502,1449503,1449506,1474482,1382992,1382997,1474143,1474484,1474486,1474488,1474490,1474492,1474494,1474496,1474498,1474500,1474502,1794608,1455657,1794553,1794554,1794555,1794556,1794557,1794558,1794559,1329073,1445174,1445187,1445204,1794571,1794574,1794575,1794576,1794577,1794578,1628035,1628036,1628037,1794579,1794580,1794581,1632909,1632916,1794582,1794583,1794584,2112617,2112609,2112610,1794585,1794586,1794587,1794589,1794590,1794568,1794569,1794570,1794606,1794588,1794607,1794453,1794454,1794455,1794560,1794561,1794562,1794563,1794564,1794565,1794566,1794567,1794591,1794592,1794593,1794594,1794595,1794596,1794597,1794598,1794599,1794600,1794601,1794602,1794603,1794604,1794605,1809608,1812396,1720423,1720424,1720425,1720426,1720427,1720428,1720429,1720430,1720431,1720432,1720434,1720436,1720437,1720438,1720439,1720404,1720406,1720407,1718106,1718107,1718108,1718109,1720410,1720416,1720411,1720419,1720420,1720413,1720414,1720415,1720394,1720395,1720396,1720397,1720398,1720399,1720400,1720401,1720402,1720403,653821,1465237,1465883,1465885,1465887,1213565,1940859,1940853,2154932,2155044,1747680,1747681,1747683,1747684,1747686,1747687,1716134,1714224,1713154,1713243,1741595,1741590,1741591,1741502,1741503,1741607,1741585,1741586,1741608,1742826,2106936,2108027,2108002,2107996,2107999,2108046,2108061,2108064,2108091,2108268,2108256,2108275,2108257,2108288,2108289,2108290,2108286,2108287,2108292,2108293,2108294,2108295,2108296,2108297,2108298,2108299,1907095,1907094,1907060,1907064,1907065,1907067,1907069,1907070,1907120,1907117,1907118,1907177,1907174,1907175,1907179,1907180,1907195,1907196,1909622,1909623,1919338,1919330,1919331,1930231,1930234,1930284,1930277,1930306,1930307,1930684,1930685,1930821,1930862,1930823,1930682,2121962,2121963,2122114,2122115,2122116,2122121,2122122,2122123,2122124,2122125,2122200,2122197,2122198,2122199,2122732,2122733,2122734,1940841,1940840,1940839,1712162,1508101,1508103,1474483,1474485,1474487,1474489,1474491,1474493,1474495,1474497,1474499,1474501,1474503,2122896,2122897,2122898,2122899,2122901,2122902,2122903,2122904,2122905,2122906]


for mline_id in move_line_ids:

        mline = sock.execute(dbname, uid, pwd, 'account.move.line', 'read', mline_id,
                ['name','date','analytic_dimension_1_id','analytic_dimension_2_id','analytic_dimension_3_id','debit','credit','amount_currency','move_id','product_id','quantity','account_id','id','journal_id','create_uid'])

        print "MLINE:",mline

        if not mline:
            continue

        if mline['debit']:
            amount = -mline['debit']
        elif mline['credit']:
            amount = mline['credit']
        else:
            continue

        aj  = sock.execute(dbname, uid, pwd, 'account.journal', 'read', mline['journal_id'][0],['analytic_journal_id'])
        move  = sock.execute(dbname, uid, pwd, 'account.move', 'read', mline['move_id'][0],['name','period_id'])

        if mline['analytic_dimension_1_id']:
            analytic_line = {
                'name': mline['name'],
                'date': mline['date'],
                'account_id': mline['analytic_dimension_1_id'][0],
                'journal_id': aj['analytic_journal_id'] and aj['analytic_journal_id'][0] or False,
                'amount': amount,
                'amount_currency': mline['amount_currency'],
                'ref': move['name'],
                'product_id': mline['product_id'] and mline['product_id'][0] or False,
                'unit_amount': mline['quantity'],
                'general_account_id': mline['account_id'] and mline['account_id'][0] or False,
                'move_id': mline['id'],
                'user_id': 1,
                'period_id': move['period_id'][0]
            }

            aline_id = sock.execute(dbname, uid, pwd, 'account.analytic.line', 'create', analytic_line) 

            
        if mline['analytic_dimension_2_id']:
            analytic_line = {
                'name': mline['name'],
                'date': mline['date'],
                'account_id': mline['analytic_dimension_2_id'][0],
                'journal_id': aj['analytic_journal_id'] and aj['analytic_journal_id'][0] or False,
                'amount': amount,
                'amount_currency': mline['amount_currency'],
                'ref': move['name'],
                'product_id': mline['product_id'] and mline['product_id'][0] or False,
                'unit_amount': mline['quantity'],
                'general_account_id': mline['account_id'] and mline['account_id'][0] or False,
                'move_id': mline['id'],
                'user_id': 1,
                'period_id': move['period_id'][0]
            }

            aline_id = sock.execute(dbname, uid, pwd, 'account.analytic.line', 'create', analytic_line) 

        if mline['analytic_dimension_3_id']:
            analytic_line = {
                'name': mline['name'],
                'date': mline['date'],
                'account_id': mline['analytic_dimension_3_id'][0],
                'journal_id': aj['analytic_journal_id'] and aj['analytic_journal_id'][0] or False,
                'amount': amount,
                'amount_currency': mline['amount_currency'],
                'ref': move['name'],
                'product_id': mline['product_id'] and mline['product_id'][0] or False,
                'unit_amount': mline['quantity'],
                'general_account_id': mline['account_id'] and mline['account_id'][0] or False,
                'move_id': mline['id'],
                'user_id': 1,
                'period_id': move['period_id'][0]
            }

            aline_id = sock.execute(dbname, uid, pwd, 'account.analytic.line', 'create', analytic_line) 
